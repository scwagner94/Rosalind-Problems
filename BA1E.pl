#!/usr/bin/perl
#Sean Wagner
#BA1E.pl
#fnids clusters of patterns in overall substring of dna
use	strict;			
use	warnings;

#(k (length of patter), L (lenght of substring of dna), t (# times))
my $dna = "GGGTGCACCAAGGGGACGAGTCGGGTTCGCACGACAGGTATATGCCCCCATCCCTCATCGGCGCGACCCGATCAGCTTCGAATGGCTACGATTCATAATCCCGTAAATCTTACCAAGGAGTGAAAGGGGTACAAAAGCACACAAAGACACCGGTATACAAACAAATCGAGACCCGTAATCTTTCCGCCGGGAGCTTAGCTTGCTCCTATTCCTAGGACACTCATAAGATAGCATCCGCGACAGGGGTAAGTACGAGATTCCGTCTGGCCCGACGGATCGTGGTTGTAACTTGGTTGTAACTTTTAAGAGTACAGGGGTTGTAACTTGTAACTTACGTATAAGTTTACGGGAATCGGCCATTTATAGGGAACCTATTAAAGGGATGTGGTTGTAACGGTTGTAACTTAGGATATACGGCACGATGACGGTTGTAACTTCTTGAGCCCGGGGGTCGTCGGTTGTAACTTATGACTAGCCGTGGTTGTAACTTTACCCTACCCATCGATGAGTGGTGTTGGGTCCCGTGCACGGTTGTAACTTGGTTGTAACTTGCAGGAGGTTGTAACTTTAACTTCGTGCACAGTTTTCAACGGGTTGTAACTTACTTACTTCGACTCGACCTGTGGTTGTAACTTTGGTTGTAACTTGCAGTCCCCCTCGCTCTGGTTGTAGGTTGTAACTTCTGCGACGAAATGTGGTTGTAACTTGCTTCATCGGTTGTAACTTAATCATGGTTGTAACGGTTGTAACTTCGGTTGTAACTTGGGTTGTAACTTATAAGGTGGTTGTAACTTTCCAATAGTGCGTTGCTTGGGCAGGGGTTGTAACTTAACTTACTTGGTTGTAACTTTCAGTTTGGTTGTAACTTCAAGACCCATACTAGGGTGTATATCAAAGGTCTTCAGACCCATACACCCATACTAGCTAGCTAGTAGAACGACCCATACTAGAGACCCATACTAGATGCGATACCTCGACCCATACTAGCTAGGTGAGGGTATACAGTGAGCCGAAGCTCGCCCGCTGTCCTGTCACCCATACTAGGAAAAAACCTACATTATGGCGCAAGCCCGGATAAACCATATCAATGTAAAACCCAACCCATACTAGCCGGTCGTTTGACCCATACTAGATACTAGCTGATGGCTGGCCACCCATACTAGATACTAGACTAGCATACTAGTGGTTGGCCCCTTCTCACCCATACTAGAGAGAGTGGCCCCTTCTATGGCCCCTTCTACCCATACTAGGATTCGCAATGTTGGCCCCTTCTTCTTGGCCCCTACCCATACACACAACGGCAAGGCAATTACCCATACACACAACGGCAACTAGCTCTAGTGCCGAAGTGGCACAACGGCAACGGCAACCTTCTCTTCTTGGCCCCTTCTCTAACCCATACCACAACGGCAAACAACGGCAACCCCACAACGGCAAATACTAGTTCTTTTGGCCCCTTCTGCCCCTTCTATGACTGAAACAGGCCACAACGGCAACACAACGGCAACCTTCACAACACAACGGCAAGTTCACAACGGCAATGGCCCCTTCTCACACAACGGCACAACGGCAAGCCCCCACAACGGCAAGGAACCGCCACAACGGCAAGCACAACGGCACACAACGGCAAAAACACAACGGCAAGTAATACCAAAACGCGTCGTGTCGATGGAGCTGCGGGTCACACGTCGTTGTGCCACAACGGCAATCACCACAACGGCAAAAGCGCCCTCACAACGGCAACCACAACGGCAATCAGTCACAACGGCAAGGGGGCACAACGGCAACCCGGAGTACGCGCGAGTTTCACACACAACGGCAAAACGGCAATGCATAAGTACAGTTCGATTCCTTGGGAAATCATCGAGGAGCGCCATTACCAAGACGGTGAGTGTTTATGAGGTAACTGCTATGTTGTCTCCCGGAGATTTATGTGACCGGTGTATGTAGACGGCACTGTAGGAATCTAGACTATGGAGATCCTGGCATCTTGCTCATTTCCTCCACTATCCCCACACAGGCTGTATAAATTACACGCGGACGGGTCATTTATGACCCTCTGAAGTCTCGGACCTTCTAAAAGGGACACCCACCCCATATCTTGCGGAGATGCTAGCTTATGGCCTCAAAAGAAAATGTACTTTCAAAAAGCGTCCAGCAGCCAAGTTTTCGTCCTCCACATCCGCGCCGATGCCCGCATCCGCGCCGGCATCCGCGCCGCGCAGGTTCGATCGTGGGTTTTTTTGTCATCCGCGCCGGCCGCGCAGCCGAATGTGTCATCCGCGCCGCCGCGCCGTTGTTCCATTCCGTTCGCGTCCATCTATACATCCGCGCCGGTGGGCCCGGCGATCGCCATCCGCGCCGTGGACATCCCATCCGCGCCGCAGCTCATCCGCGCCGTCCAGATGGCTGGGCGAGCACCTCTCCCATCCGCGCCGGACGGAAACGTCGATGGCGGCGCGTCACCATCCGCGCCGCCGCATCCGCGCCGCCGCGCCGGGGGATTGAGCCCTTCAGTCATAGTCCTAATGAAGTGACCATCCGCGCCGTGGTCTGAAACATCCGCGCCGGCGCCGCTTGCGTCATTTTCATCATCCGCGCCGCGGAAGCATCCGCGCCGTCCGCGCCGTTAAAGTCGCATCCGCGCCGCGCCGGCTGTGCCACATCCGCGCCGCCATATCAGATTTAGCCTTCCATCCGCGCCGTCCGCGCCGCAGTGCTGTATGTATCGTGTATCGGTTGTATCGGTAGACCATCCGCGCCGCGCTATATGTATCGGTAGAAGTCACCTACGTGTATCGGTAGGCCCTGTGTATCGGTAGACAGAATGCGCAGCCCGTGTTGTATCGGTAGGTAGCTGTGTATCGGTAGATGTATCGGTATGTATCGGTAGTAGTGTATCGGTAGACGATGTATCGGTAGTTGTATCGGTAGTGGGCCAAGCGCAGCTTCCTTGTTAATTCGTTGATCTGTATCGGTAGCATCGGGAGTGGCCTATGTGTATCGGTAGGGTTACGTTCGGGGCCTTCTGTATCGGTAGAGGTCGGGTTCGACACGGTGTCATGTATCGGTAGATGTATCGGTGTATCGGTAGGTACGACGGGCAGCGTCAGAGATCCCGTCCAAGCCCTAAGGGAGATAGATAGAACAGCAGGAATGCATCGCTGCTAGGAGCATAACATCGTGTATCGGTAGGTTGTCCCGTCGGATTGTGACCGTTCCTTTGCCCATTGTATCGGTAGCGCCTCCATACCATGTATCGGTAGTAGTGTTCTATGTATCGGTAGCGCGGATTACTGTATCGGTAGCGGTACAAGAGTCGGCCCTCGAGGGGGATTGCGTCAAATCTCACACCCGGGTAAATAAAGACCCATACCGAGCCACAACGAGTAGGTCATGCACCGAAGAACGAAAGGCGGCCGGACCAGATAGGACGAACTCAGCATCTGTCACAACCCACGAATAGATGAACCAGACAATAAGCCGACTAAAAAGTCTTGAATTCTATCTCTGAGTTGTGAATCCTAAACGTCTAGCTATTCTCGATCTCGTTGACACTTGCAGGTTATTCGCAGGATAAATTAAGGCGATGCCGATCCGCACGTGACAATGCTGCCATAACATTCAGTAACCAATATTGCCTGTCCTGGCAAAGACGGTTGTGCTCGGGCCGCAAGTAAGCACGTCAGATACGCTGGGCAGGCTAATACGCGGATGATGCCGTAGAAGTCGCTGTACCCAATTGATATAACAGAGACCACAATGTGGGATCTCTTATGTTGGCGGACAAATCGCGAGGACGCTCTAACGCCAACGCTGTACGTAACACTCAGGGAGACTTTAAATACAAAGGACGGTGAAGAGGTTACCGCGTGGGTTATGACGGAAGAGTTGTCAAGTTAACTGGTATTGTCCCGCGTTATGGGTCATTGTGGCCATCGTCAATGTTCACCAAAGGAGTTGAGTCCGGTGTGTCGACGGTGTTGTGACGGCTTGGATTTCCCTGCTAAAGGGCAACGACGCGACTAGTTGAATTTTGTATCCACTAATACCCTCATCTGAGAACCAGCAGAATTATATAGGCTAGCCTACCGGTCAAACTGAAGGATGAAGCGTACCCCGACTGTGTAAACCGTTACTACCTAGAGAGGATGAAGCCATGTGCAGAATGCGCGGGTGTTCACTACGAAGAAGATGTCGGAAGTTGACCAGCTAACAAGACGTTGCCATTTGTATGAAGAACATCTGTTGACCGCAACCCACGTACGCCGACCCGACAAACGCTAACACGTCATTACCGCAATTCAAGGGGAGCTCTTACTTGGGTGATGCCTGCAACAGTATGCGAACCCGCTTGGGGAAGTCCCCAGCGCCACAGGTCGTGTAACACTTCGTAAAAGGCTGACACACCTCAAAGATCCAAATAGGTTCCATCGCCAATTTCCCCCTGGGGGCTCATATCCACCAGTCACTCTCATGCCGAAGAGGGTATGGTCCGTTGGGGTCGTGCCGGATACTTGACGCTTGGAGTTGGCTCAACTGCGCTACCATAAATCGCTAGGAGGCTCTGAGCACGCCGCATTTGGCAATTGGTATATCAAATCTTCGGAGGAGGTGCAAAGTATTTGTGGAAAGCAATTACCTACACGTATCGCTCAAGGGTGCATTGATCAAGTCAATTCACCCTTGCTTACCCCCTGTTGAAGCCAGCCGCAAGATGTATCGACGTACTTACCTGTGACTAGAGACTGGACTATTCCGAGCGAGGGGAGCGCGGCCCGTTTCATGGAGATTATCAATACCGGTTGCATACAATATGTATCTCAGTCGACTGATAAGTGGCACCTTCATCTCTGTAAATGCCCTTGTACACCTCCGTCTGGACGTACTGAGGTACGCTAAGTATAAATGCCTATAGCCCTTTCCATGGCGCCGACCATTCCATGGCGCCGCCATGGCGCCGGCGCCGGCCGAAGACTGGCATCTTATGGGATCCATGGCGCCGAACGAAGTACCATATAGCAGTTGAGTGGTACCAACAGCCATGGCGCCGTTTGCGGCTCGGTACCGATCGGTTGGCAACCATGGCGCCCATGGCGCCGGGACATTGGCGCCCATGGCGCCGCGCCATGGCGCCGTCCCATGGCGCCGCTCACTAAAAAACCATGGCGCCGCCCAAAATAATGGGGAATTAGGACTCCATTACAGACCATGGCGCCGCCATGCCATGGCGCCGGCCGCGCCGAGAAAAGTGCTTTAATTAACCCAACCCATGGCGCCGCAGTTGTAACCATGGCGCCGCGTTATGCTGATCCATGGCGCCGCCCCAGGGGGCGGAGCAACTCCGTACACGCCGATCCATGGCGCCGCATGGCGCCGGGAACCATGGCGCCGGTTACTGACGAAGAGCCAGATTGCAGTCTCACGGCAGTAACGGAAACGGAAAGAGTCTAACCCTGAAATAGTCCATGGGCAGTAACGGCAGTCCCGTCTGGCCGCCCCGTCTGGCCCCCGTCTGGCCCGTCTGGCCGCAGTAACGGATCGGCCCGTCTGGCCTAACGGACGGAAGCTAGCAGTAACGGAAGCACCCGTCTGGCCCTGGCCCCGTCTGGCCCCCGTCCCGTCTGGCCTGGCCTAACGGATTGTGGCAGTAACGGAAGTAAGCAGTAACGGAACTGGAAACCCGTCTGGCCGCCCGGACACCGCAGTAACGGAACGGCCCGTCTGGCCGCAGTAACGGCAGTAACGGATGGCCCGCCCGTCTGGCCGAGGATCGGCCCGTCTGGCCCAGTAACGGAGAAGCGAGGGCTCCCGTCTGGCCCCCGTCTGGCCGTCTGGCCCTGGCCCAGTAACGGCCCGTCTGGCCCCGTCCCCGTCCCGTCTGGCCCTACGCGCAGTAACGGAGCAGTAACGGAATCCCCTTCAAGCAGTAACGGAGGCAGTAACGGATCCCGTCTGGCCCGGAGAATAAGACCCGTCTGGCCACCCCGTCTGGCCATCGCAGTAACGCCCGTCTGGCCTCTGACCCGTCTGGCCTGTTTTAGGTATAGATTCGCAGATACGCGCCCGTAGTCGAACCGCTCCGCCGTAGCCTATCCTGAACAACCGATCAACTATACAAAAGCTGCTGTCTGTCGCTATCGGTTGGGTGGACACTGCTGTCTGTCGAGGCACAGGCTGTCTGTCGAGCTGTCTGTCGTGTCGGCGCTAGCGACCTCTTCACGGTCACTTTTGTGCTGTCTGTCGTAGTGATCAGCCCGGTGGAGCTGTCTGTCGGTCATTAACCGCTAATTTTCTCCTGTGTTAATGCTGTCTGTCGGTCGTTGGGAAGCCTTCGTAAGAATTAATCAGAAATCAGCTGGCTGTCTGTCGCTGTCTGTCGCAAAGTGCTCCCCCGCAGCTGTCTGTCGGACTTACAAATCGTGAAGATCTCGAGCATCGGCTGTCTGTCGGGCACACCCGGACATGCTGTCTGGCTGTCTGTCGGTCGCGCGCTGTCTGTCGCGGATTACTCGCGCGGATGCTGTCTGTCGAGAGCTGTCTGTCGGCTGTCTGTCGACGCTGTCTGTCGGTCGCGGATTACTACGCCAATTAGCTTCGCGGATTACGCTGTCTGTCGCTGTCGACGGGCCTGGCGCGCTGGCTGTCTGTCGTACGCTGTCTGTCGTGCCCTTCGTAGCGCCGCGGATTACTCGGATTACTGCGTCTAGTTCGGACCGGTCCGCCGCGGATTACGCGGATTACTCAGGGTCCCATTGAACGCGGATTACTTTATAGGCGTCGCGGATTACTATAAGTCCGGTCGGTATTTCGCTATCGCCGCGGATTACTTACACGCGGATTACTTCCGCCACGCGGATCGCGGATTACTTAGTCGCGCGGATTACTGGATTACTCTGGTTCAAGCAGCTACTGTTCAATAGTCGCGCGGATTACTAAGCTCATCGCGGATTACTTTGGCGCGGATTACTGTGGGTGAGCGCGGATTACTCTCGCGGATTACTCCTACGTTTAAGCGGTCCAATTGCCAGGTCTTGAGTTAGGATCACCTCCCATCCCTACGACATCCTGTAAAGTCTGCATTCCGCGTTTGCCCCCTGCTCTCTGAGTCGCGTAGTCCACCGCCTGAGAACCAACAACGAGCGCCATATCCCAGGTAATGACTATAGCTGGACGGTTTTTGTTCAGTGAAGAGTGCACTTATAAGACAGCGATTACCGTCGAGACCGAGAGGTACTTCTTTGCACCCCTTGATGGAGAGGGGAACAGAAATTAAGCTCAATAATTTTGGCGCGATGCGAGTTGATTTGAGTGGTCTAATTGTTTGGGTGATGTACATTACACCGGCCTAGTTGGTTCGGATACGTAACTACTATAACGTACCGGTGTGGTAGTAGTCACCCGGGCTTTTTTATGACCGGATACAGTACGGATCGCTCCGCTCCCTATATTGAAAAAGTGCAGGATGAGGCCCACACGCGGATAGCAAAGATTTGGTAGAAATATGTTTGTGGGCCCATTACCGATAGGCCTGATCATGACGGTCGAACATATAGCTGTTCTGGAGAGCGACTTTGGATTGTTACCGAGCCCCAGGAAACACCGGACGCATGGCGCAGAAGGCACTAATCATCCTGGGGCAATCATAGCATTATTACCGGGTAGTAATGGCTGCGACGAGGCGTCACGCAAGGCCTGGCACCTAAGACTGGTGAAAACCCCAGATTGACCGCCGGCTCGGTCATTTCGCTTCCTGTGACCTAGTGTTCCGTAAACGCGATGCGCTGTAAGGTTGCCTTTCGCCGACAGCGAGTGAGAGAGTGCCCCGCGAGTGGTGAAGCTAAAAATGAGAGGTTGGTCGGGCGCAGTCAGGCACAGTGCACGGTAACAGCCTGTGTATACCTGCCACTGGTCGGCCCGGCCAAGACAGTCATGGGTTCGAACGCAATAGTATATCCAGGAACTTCTCGAAAATCTATGACGTGTAGCAGAGGGAGAGTCATCTGTTCAAAGTAAGCCTATGGTCCATTTAGATAGTTCGCACTAAATAACCATCCGATAACCATCCGAGACACGCCGTAATATAACCATCCGCGATCCGCTTATAACCATCCGAGATCGTACTATTTATAGCGCATAACCATCCGCCGCCGACCATAACCATCCGTGGTACGTATAACCATCCGTAGAATTAGCCTTGAAGATAACCATCCGATAACCATCCGCATCCGATTTTTTGCAATATAACCATCCGAATAACCATCCGTCGGGGTTCTGCGAGCTGTGCCACCATAACCATCCGCCTGATAACCATCCGGAACGATCAGATCCTTCGTATAATAACCATCCGCCGCCGTTATAACCATCCGACCGCGGCAAATAAACCCCAAGTCTCATAACCATCCGGCCTATGCGCACAACAAATAACCATCCGAGCACCGCATCAGCATAACCATCCGAACTAAATAACCATCCGTTCTAGGCAAGGCTTCTTTCTTGTTAACGTATATCGCATCAACGGCGTGATCACTAATAACCATCCGCCATAACCATCATAACCATCCGACCATCCGACCGCCCATCTTTCTTCGGTGCATCGTGGAGATAGGATTCCGAGTCTCGAACATAACCTTTTCGGAAACAAGGGCGTATGAGACCCAAATTCCATACTGTTGTTTGTACACAGAGGCGCAACAATACTCACACTTCTAATAATCCTCTCCACCTGTAAAGTCATCGCATGGCATGGGGGATTAGTTGTGTTAGTACGGGCTGCTACTAGTGAGCCACAAAACCCAATTATAATTCATAGTCTTTTACTCCCCTACTATCTCCACAGGGTATACGAACGGTTTATGAGTAGCCAGGGTGCTACCCTCCCTGTAGCTAAGGTCGGACGCGCAATTCCGTCCGCCCTGCTTCCATTGGTAAAGGACGGTTCACGTGGGCCCATCTTCAAGTATATGGCGGGACTAAAGAAGAAAAAGCAGTCATATCCCGCTTGCAAGGCTGCTCGCGACACCGTCGGCTTATGTAAGGATGGTTACTACCTGTCTCGTCAGGGGATTATACCGCCAAAGATAGACACCCCCCAAGAGATTAGAACGTCGTGTCGAGTACGGCCCAAGTCCTTTGCGAGCTATGTCGTTTCGCACAGTAAAACCCCGAATATGGCATCCTGCCGGTTCCCCAATTCGCAACAGGTGCTCACCCGTCCATGAGATTTAGTCTTCGTCGCGGTGGCTACCCCTATTACAAGCGATACCGACAATTATTCGTAGGGGCGTGGATGTTAATTTCTCGACGGCGATTTTGGGGGTCATGCCCTCTGGGACGGGCATTACGCAGCCGTCTATTGGTCGGACCCATCCTCGGAGATTTAGCCCCCTTATCTGTACGGGTATCGCGACAAGTTATATTCATCCTAGCCCGAAGGATGTTTAATCTAACTAGTCTAAGTCCGAACTTCTATCAATGATCAATTCATATACCCGAGCGAAAATCATCTTCTCTATGGCCGGACGGGCAGGCGGGATTACAATTTCGCCCGTCCGCCGTCATAATGTTACGGGTAGCTACCCGGATTAGGCTCGGTCAACTCTCCGCATATTCCTTGTCTGCTAGAGAGATGGCATCGCATGATCCTAGGTATACGAAACCTGTTCCAACGCTAAGGTCAGACGCCCGACACGGAGCTAACTTTATATGCTATAAGTGGCTGGGGTAGGCTGGGCCAGATCATGGGGTCTCCTACGAGCGATCCTCCATGCTTGCTTCTGTACGAATGCCCGCTAGCCTGTAACGGCCCTTTTGGTGCGAAGTTA";
print "Input a k: "; #gets len of the pattern
my $k = <STDIN>;
print "Input a L: "; #gets len of reading frame
my $L = <STDIN>;
print "Input a t: "; #gets number of occurances
my $t = <STDIN>;

my $maxLen = length($dna) - $L;
my @patterns; #list for output

#runs through entire list, ignores overhang
for(my $i = 0; $i<=length($dna); $i++) {
	my $tempDna = substr $dna,$i,$L; #gets substring
	#this still gets relevant reading frame even if it runs over, so run loop to the end 
	my $currentPattern = substr $tempDna,0,$k; #gets a pattern at beginning location
	my $count = 1;
	for(my $j = 1; $j<=length($tempDna); $j++) {
		my $newPattern = substr $tempDna,$j,$k; #checks against substring
		if($newPattern eq $currentPattern) {
			#print "FOUND ONE\n";
			$count++; 
		}
	}
	if($count==$t) { #if count matches, adds to arr
		push @patterns,$currentPattern;
	}
}

#simply reverses and prints the lists
@patterns = reverse(@patterns);
print "\n\n";
while(@patterns) {
	my $tempOut = pop @patterns;
	print $tempOut," ";
}

print "\n\n";